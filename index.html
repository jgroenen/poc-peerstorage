<!-- demo.html: textarea synced via yStorage -->
<!doctype html>
<meta charset="utf-8" />
<textarea id="t" style="width:100%;height:90vh"></textarea>

<script type="module">
  import { createYStorage } from "./y-storage.mjs";

  const roomId = location.href;
  const yStorage = createYStorage({
    appId: "poc-peer-storage",  // must be stable across your app :contentReference[oaicite:6]{index=6}
    roomId,
    // relayUrls: ["wss://relay.damus.io","wss://nos.lol"], // optional
    // password: "shared-secret", // optional
  });

  const ta = document.getElementById("t");
  ta.value = yStorage.getItem("text") ?? "";

  ta.addEventListener("input", () => yStorage.setItem("text", ta.value));

  yStorage.addEventListener("storage", (e) => {
    if (e.detail.key !== "text") return;
    const v = e.detail.newValue ?? "";
    if (ta.value !== v) ta.value = v;
  });
</script>
